#! /usr/bin/env node --harmony_arrow_functions --harmony_rest_parameters

'use strict';

let fs        = require('fs');
let path      = require('path');
let scope     = require('../src/core/scope');
let stdlib    = require('../src/core/lib/stdlib');
let parse     = require('../src/core/parser');
let interpret = require('../src/core/interpreter');
let args      = require('minimist')(process.argv.slice(2));

if (args.e || args.E) {
  interpret(
    parse(args.e || args.E),
    scope.createScope(stdlib, scope.createScope({__filepath__: process.cwd()}, {}))
  );
}
else {
  interpret(
    parse(fs.readFileSync(args._[0], {encoding: 'utf-8'})),
    scope.createScope(stdlib, scope.createScope({__filepath__: path.dirname(path.resolve(process.cwd(), args._[0]))}, {}))
  );
}
